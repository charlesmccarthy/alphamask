(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{4305:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(5567)}])},5567:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return y}});var a=n(1527),l=n(8861),s=n.n(l),r=n(959),i=n(5341);let o=e=>{let{size:t=60}=e;return(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:(0,i.Z)("w-".concat(t," h-").concat(t)),children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 15.75l5.159-5.159a2.25 2.25 0 013.182 0l5.159 5.159m-1.5-1.5l1.409-1.409a2.25 2.25 0 013.182 0l2.909 2.909m-18 3.75h16.5a1.5 1.5 0 001.5-1.5V6a1.5 1.5 0 00-1.5-1.5H3.75A1.5 1.5 0 002.25 6v12a1.5 1.5 0 001.5 1.5zm10.5-11.25h.008v.008h-.008V8.25zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"})})},c=()=>(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor",className:"w-4 h-4",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"})});async function d(e,t){if(!t)throw Error("No 2d context");t.imageSmoothingQuality="high",t.save(),t.drawImage(e,0,0,e.naturalWidth,e.naturalHeight,0,0,e.naturalWidth,e.naturalHeight),t.restore()}var u=n(5670);let h=(e,t,n)=>{let a=t.getContext("2d");return a?(a.scale(n,n),a.clearRect(0,0,t.width,t.height),d(e,a),a.getImageData(0,0,t.width,t.height).data.buffer):Promise.reject(Error("Failed"))},m=e=>new Promise((t,n)=>{try{e.toBlob(e=>{if(!e||(null==e?void 0:e.size)>12e6){let e=Error("Use a file smaller than 12 MB.");n(e)}else t(e)},"image/png",1)}catch(e){console.error(e),n(e)}});var x=n(1951);let f=e=>{let{isEnabled:t=!0,canvasRef:n,strokeWidth:l,waitInpaint:s,setHasInpainted:o,width:c}=e,[d,u]=(0,r.useState)(0),[h,m]=(0,r.useState)(0),[f,g]=(0,r.useState)(!1),v=(0,r.useRef)(null);return(0,a.jsxs)("div",{onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),ref:v,onMouseMove:e=>{let{clientX:t,clientY:n}=e,{x:a,y:l}=v.current.getBoundingClientRect();u(t-a),m(n-l)},className:(0,i.Z)("absolute top-0 left-0 w-full h-full cursor-none",s?"pointer-events-none bg-slate-500":""),style:{zIndex:100,pointerEvents:t?"auto":"none"},children:[(0,a.jsx)("div",{className:"absolute h-full pointer-events-none",children:(0,a.jsx)("div",{className:(0,i.Z)(f?"":"hidden","canvas-cursor"),style:{position:"relative",left:d,top:h,width:"".concat(l,"px"),height:"".concat(l,"px")}})}),(0,a.jsx)(x.x,{onChange:e=>o(e.length>0),ref:n,strokeWidth:l,strokeColor:"#fff",canvasColor:"transparent",style:{border:0,opacity:.6,width:c}})]})};function g(e){let{className:t,bgAccent:n="slate",...l}=e,s="bg-".concat(n,"-600 hover:bg-").concat(n,"-700 active:bg-").concat(n,"-700");return(0,a.jsx)("button",{className:(0,i.Z)(t,"inline-flex items-center gap-2 justify-center rounded-md py-2 px-3 text-sm outline-offset-2 transition active:transition-none","font-semibold text-zinc-100 active:text-zinc-100/70 ",s),...l})}var v=n(4035),p=e=>{var t;let{previousImageURL:n}=e;(0,v.useRouter)();let[l,s]=(0,r.useState)(null!=n?n:""),[x,p]=(0,r.useState)(""),[w,j]=(0,r.useState)(""),y=(0,r.useRef)(null),b=(0,r.useRef)(null),N=(0,r.useRef)(null),[k,C]=(0,r.useState)(30),[I,R]=(0,r.useState)(!1),E=(e,t)=>{let n;e.preventDefault(),e.dataTransfer?n=e.dataTransfer.files:e.target&&(n=e.target.files);let a=new FileReader;a.onloadend=()=>{let e=a.result;t(e)},n[0]&&(j(n[0].name),a.readAsDataURL(n[0]))},_=async()=>{let e=await M(),t=await L(e);document.createElement("a");let n=URL.createObjectURL(new Blob([t],{type:"image/png"}));!function(e,t){let n=document.createElement("a");n.href=t,n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(t)}("image.png",n)};async function L(e){let t=N.current,n=b.current;t.width=n.naturalWidth,t.height=n.naturalHeight;let a=t.getContext("2d");d(n,a);let l=await m(t);if(e){let e=new Uint8Array(a.getImageData(0,0,t.width,t.height).data.buffer.slice(0)),n=new Uint8Array(await B());l=function(e,t,n,a){if(e.length!==t.length)throw Error("Image and mask dimensions do not match.");let l=new u.PNG({width:n,height:a});for(let n=0;n<e.length;n+=4){let a=255===t[n]&&255===t[n+1]&&255===t[n+2];a&&(e[n+3]=0),l.data[n]=e[n],l.data[n+1]=e[n+1],l.data[n+2]=e[n+2],l.data[n+3]=e[n+3]}let s=u.PNG.sync.write(l,{colorType:6}),r=new Blob([s],{type:"image/png"});return r}(e,n,t.width,t.height)}return l}let B=async()=>{var e;let t=document.getElementById("react-sketch-canvas__canvas-background");null==t||t.setAttribute("fill","#000");let n=await (null===(e=y.current)||void 0===e?void 0:e.exportImage("png"));return null==t||t.setAttribute("fill","transparent"),new Promise((e,t)=>{let a=N.current,l=b.current,s=a.width/l.width,r=new Image;r.src=n||"",r.onload=async()=>{try{let t=await h(r,a,s);e(t)}catch(e){t(e)}}})};async function M(){var e;let t=await (null===(e=y.current)||void 0===e?void 0:e.exportPaths()),n=!!t&&t.length>0;return n}return(0,a.jsxs)("div",{className:"container  flex flex-col w-full",style:{alignItems:l?"center":"auto"},children:[(0,a.jsx)("div",{className:"text-2xl w-full text-center py-3 font-semibold text-slate-800",children:"Motion Brush"}),(0,a.jsxs)("div",{className:"border border-slate cursor-pointer py-1.5 px-1 rounded shadow-sm focus:outline-none flex flex-col items-center",style:{height:l?"45px":"80%",maxWidth:l?"600px":"100%"},children:[(0,a.jsx)("label",{className:"relative h-full shadow-sm bg-slate-100 cursor-pointer w-full flex justify-center pl-1",htmlFor:"file",children:(0,a.jsxs)("div",{className:(0,i.Z)("h-full text-slate-500 flex p-1 gap-3 items-center",l?"block text-sm":"py-[20%] flex-col text-lg"),children:[(0,a.jsx)(o,{size:l?6:60}),(0,a.jsx)("div",{className:"w-full text-center",children:w||"Select Image to Transform"}),(0,a.jsx)("span",{className:"sr-only",children:"Select Image"})]})}),(0,a.jsx)("input",{id:"file",accept:"image/png, image/jpeg",onChange:e=>E(e,s),type:"file",className:"hidden w-full text-lg text-slate-500 file:rounded-full file:border-0 file:text-lg file:font-semibold file:bg-transparent file:text-gray-700"})]}),l&&(0,a.jsxs)("div",{className:"flex flex-col items-center gap-6 my-3",children:[(0,a.jsxs)("div",{id:"image-container",className:"relative shadow-sm",children:[(0,a.jsx)(f,{canvasRef:y,strokeWidth:k,waitInpaint:!1,setHasInpainted:()=>{},width:null===(t=b.current)||void 0===t?void 0:t.width}),(0,a.jsx)("img",{crossOrigin:"anonymous",ref:b,onLoad:()=>{var e;return null===(e=y.current)||void 0===e?void 0:e.clearCanvas()},src:l,className:"pointer-events-none max-h-[90vh] lg:max-h-[70vh]"}),x&&(0,a.jsx)("p",{className:"text-red-600 pt-3 text-xs",children:x})]}),(0,a.jsx)("span",{className:"hidden zinc-100 bg-slate-600"}),(0,a.jsxs)("div",{id:"action-btns",className:"flex flex-col items-center gap-3",children:[(0,a.jsx)("div",{children:"Paint over the parts of the image that you want to animate"}),(0,a.jsxs)("div",{className:"flex items-center flex-1 p-1",children:[(0,a.jsx)("div",{className:"pl-1 pr-3 text-sm",children:"Brush Width"}),(0,a.jsx)("input",{type:"range",min:"3",max:"100",value:k,onChange:e=>C(parseInt(e.target.value))}),(0,a.jsxs)("div",{className:"pr-3 pl-1 text-sm w-3",children:[k,"px"]})]}),(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)("button",{className:"p-1 bg-sky-100 m-1 text-sm rounded",onClick:()=>{var e;return null===(e=y.current)||void 0===e?void 0:e.undo()},children:"Undo"}),(0,a.jsx)("button",{className:"p-1 bg-sky-100 m-1 text-sm rounded",onClick:()=>{var e;return null===(e=y.current)||void 0===e?void 0:e.redo()},children:"Redo"}),(0,a.jsx)("button",{className:"p-1 bg-sky-100 m-1 text-sm rounded",onClick:()=>{var e;return null===(e=y.current)||void 0===e?void 0:e.clearCanvas()},children:"Clear"})]}),(0,a.jsx)("div",{className:"flex gap-3 items-center",children:(0,a.jsxs)(g,{onClick:_,className:"w-40 max-h-10 flex gap-3",children:[(0,a.jsx)(c,{}),(0,a.jsx)("span",{children:"Masked Image"})]})})]})]}),(0,a.jsx)("canvas",{ref:N,className:"hidden"})]})},w=n(6353),j=n.n(w);function y(){return(0,a.jsxs)("div",{className:"flex min-h-screen flex-col px-4 lg:px-24 items-center ".concat(s().className),children:[(0,a.jsx)(j(),{children:(0,a.jsx)("title",{children:"Motion Brush"})}),(0,a.jsx)(p,{})]})}}},function(e){e.O(0,[230,297,774,888,179],function(){return e(e.s=4305)}),_N_E=e.O()}]);